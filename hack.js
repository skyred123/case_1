System.register("chunks:///_virtual/BattleMainServer.ts",["cc","./BattleData.ts","./BattleMain.ts","./Record.ts","./EnumDefine.ts","./EventInvoker.ts","./ChapterArtifactGemCC.ts","./index65.ts","./ChapterCrossPvpServer.ts","./ChapterCrossWarMonsterServer.ts","./ChapterCrossWarServer.ts","./ChapterGvgServer.ts","./ChapterHalloweenPvpServer.ts","./ChapterRoleSoloServer.ts","./ChapterSlavePvpServer.ts","./ChapterStrategyActivityServer.ts","./ChapterWorldBossServer.ts","./MapCamera.ts","./RenderMgrServer.ts","./ChapterMainServer.ts","./ChapterArenaServer.ts","./ChapterSoloServer.ts","./ChapterCoinServer.ts","./ChapterDiamondServer.ts","./ChapterTeam3Server.ts","./ChapterFarmServer.ts","./ChapterFateServer.ts","./ChapterParkPvpServer.ts"],(function(t){"use strict";var e,r,a,n,s,i,o,h,p,v,c,u,C,S,l,f,d,m,M,g,P,y,R,b,D,w,E,A;return{setters:[function(t){e=t.cclegacy},function(t){r=t.ChapterType},function(t){a=t.BattleMain},function(t){n=t.Record},function(t){s=t.RunMode,i=t.RunState},function(t){o=t.EventInvoker},function(t){h=t.ChapterArtifactGemCC},null,function(t){p=t.ChapterCrossPvpServer},function(t){v=t.ChapterCrossWarMonsterServer},function(t){c=t.ChapterCrossWarServer},function(t){u=t.ChapterGvgServer},function(t){C=t.ChapterHalloweenPvpServer},function(t){S=t.ChapterRoleSoloServer},function(t){l=t.ChapterSlavePvpServer},function(t){f=t.ChapterStrategyActivityServer},function(t){d=t.ChapterWorldBossServer},function(t){m=t.MapCamera},function(t){M=t.RenderMgrServer},function(t){g=t.ChapterMainServer},function(t){P=t.ChapterArenaServer},function(t){y=t.ChapterSoloServer},function(t){R=t.ChapterCoinServer},function(t){b=t.ChapterDiamondServer},function(t){D=t.ChapterTeam3Server},function(t){w=t.ChapterFarmServer},function(t){E=t.ChapterFateServer},function(t){A=t.ChapterParkPvpServer}],execute:function(){e._RF.push({},"8b530VD1TNHvqpz6HP9IbNO","BattleMainServer",void 0);const B={[r.Main]:g,[r.Arena]:P,[r.Solo]:y,[r.Coin]:R,[r.Diamond]:b,[r.Team3]:D,[r.Farm]:w,[r.RoleSolo]:S,[r.Fate]:E,[r.WorldBoss]:d,[r.Gvg]:u,[r.CrossPvp]:p,[r.StrategyActivity]:f,[r.CrossWarPvp]:c,[r.CrossWarMonster]:v,[r.ParkPvp]:A,[r.HalloweenPvp]:C,[r.ArtifactGem]:h,[r.Slave]:l};t("BattleMainServer",class extends a{constructor(t){super(t),this.result=0,this.battleEvent=void 0,this.mapCamera=new m,this.renderMgr=new M}start2(t,e,r){this.data.chapterId=t.chapterId,this.data.chapterType=t.chapterType,this.data.chapterMode=0,this.chapter=new B[this.data.chapterType](this),this.chapter.setChapter(this.data.chapterId,!0);const a=this.chapter.config;this.mapCamera.nextPart(a.part?a.part-1:0),this.mapCamera.startPartMove(0),this.playerAuto=1!=e,1==e&&null!=r&&(this.runMode=s.Check,this.curRecord=new n(this),this.curRecord.fillCommand(r)),this.data.playerList=t.playerList,this.data.openServerDay=t.openServerDay,this.data.buffs=t.buffs,this.data.monster=t.monster,this.data.playerImage=t.playerImage,this.frameCount=0,this.runState=i.Running,this.chapter.init(),this.chapter.loadData(this.mapCamera.offsetX),this.chapter.start(),this.unitMgr.updateDepth()}start(t,e){this.start2(t,0)}update(t){this.runState!=i.Stop&&this.gameLogic(t)}toResult(t,e=!1){if(this.runState!=i.Running)return!1;this.unitMgr.battleOver(),this.mapCamera.nextPart(0),this.mapCamera.startPartMove(0),this.unitMgr.clear(),this.renderMgr.clear(),this.runState=i.Pause,this.result=t,this.battleEvent&&this.battleEvent.clear()}now(){return Date.now?Date.now():+new Date}gc(){}playSound(t){}on(t,e,r,a){this.battleEvent=this.battleEvent??new o,this.battleEvent.on(t,e,r,a)}emit(t,e,r,a,n,s){this.battleEvent&&this.battleEvent.emit(t,e,r,a,n,s)}}),e._RF.pop()}}}));
